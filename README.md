# ClearFund

![Next.js](https://img.shields.io/badge/Next.js-14-black?style=flat-square&logo=next.js)
![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue?style=flat-square&logo=typescript)
![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.0-38B2AC?style=flat-square&logo=tailwind-css)
![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)

A trust-first, Web3-enabled crowdfunding platform focused on **verification, transparency, and accountability**.  
ClearFund combines modern frontend architecture with blockchain primitives to ensure every contribution is traceable and auditable.

Built with **Next.js 14**, **TypeScript**, **Tailwind CSS**, and **wagmi**, with an Express backend and Supabase integration.

---

## Live Demo

[View Live Demo](https://clear-fund-website.vercel.app)

## Preview

| Hero Section | Campaign Details |
|:---:|:---:|
| <img src="https://github.com/user-attachments/assets/11dbdb2d-c227-4b6a-87e5-194c129fa625" width="100%" alt="Hero Section"> | <img src="https://github.com/user-attachments/assets/1e6ed80f-9c9d-4dee-b401-b0a7f6838f2c" width="100%" alt="Campaign Details"> |

| Transparency Feed | Trust Features |
|:---:|:---:|
| <img src="https://github.com/user-attachments/assets/38198334-b018-4325-b491-9aee89876f57" width="100%" alt="Transparency Feed"> | <img src="https://github.com/user-attachments/assets/5d6315ae-882e-470c-abf1-75fce0fe440e" width="100%" alt="Trust Features"> |

---

## Key Features

- **Verified Crowdfunding** – Campaign creators are verified via identity-backed workflows.
- **Wallet-Based Donations** – Secure wallet connections using wagmi + viem.
- **Live Transparency Feed** – Real-time donation and verification activity.
- **Campaign Spotlight** – Featured, trending, and verified campaigns.
- **Milestone-Based Funding** – Funds released only after validation.
- **Dark, Institutional UI** – Trust-first design with minimal motion.
- **Fully Responsive** – Desktop-first, mobile-friendly layout.
- **Vercel Ready** – Optimized for production deployment.

---

## Architecture Overview

ClearFund follows a modular, scalable architecture:

### Frontend
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Web3**: wagmi + viem
- **State**: React hooks + server components

### Backend
- **Server**: Express.js (Node.js)
- **Purpose**: Campaign data, donation records, verification logic
- **Design**: REST-based, extensible for smart contract integration

### Database
- **Supabase** (PostgreSQL)
  - Users
  - Campaigns
  - Donations
  - Verification metadata

### Storage
- **IPFS (Pinata)** – Campaign metadata & proofs (stubbed integration)

---

## Project Structure

```
clearfund/
├── contracts/                  # Solidity smart contracts
│   ├── ClearFundFactory.sol    # Campaign registry and deployment
│   └── CrowdfundEscrow.sol     # Individual campaign vault (escrow)
├── scripts/                    # Hardhat deployment and testing scripts
│   ├── deploy.ts               # Deploys factory to Sepolia
│   ├── test-*.ts               # Functional test scripts
├── typechain-types/            # TypeChain generated bindings (autogenerated)
├── artifacts/                  # Compiled contract artifacts (autogenerated)
├── src/
│   ├── app/                    # Next.js App Router pages
│   │   ├── campaigns/          # Campaign listing and details
│   │   ├── about/              # Static pages (about, compliance, privacy)
│   │   ├── layout.tsx          # Root layout with providers
│   │   └── page.tsx            # Home page
│   ├── components/             # React components
│   │   ├── modals/             # Donate modal, verification flows
│   │   ├── campaign/           # Campaign spotlight, details
│   │   ├── hero/               # Landing hero section
│   │   ├── trust/              # Trust and transparency features
│   │   ├── cta/                # Call-to-action sections
│   │   └── layout/             # Navbar, Footer
│   ├── lib/
│   │   ├── contracts.tsx       # Contract addresses and ABIs
│   │   └── config.ts           # App configuration
│   ├── data/
│   │   └── campaigns.tsx       # Mock campaign data for preview
│   └── styles/                 # Global CSS and Tailwind setup
├── server/
│   └── index.js                # Express API server (auxiliary)
├── public/                     # Static assets
├── deployment-info.json        # Factory/escrow addresses from latest deploy
├── hardhat.config.ts           # Hardhat configuration
├── tsconfig.hardhat.json       # TypeScript config for contracts
├── next.config.ts              # Next.js configuration
├── tailwind.config.ts          # Tailwind CSS configuration
├── package.json                # Dependencies and scripts
└── README.md
```

## Prerequisites

- **Node.js** 18+ (verified with npm/pnpm)
- **pnpm** (recommended) or npm
- **MetaMask** or compatible EVM wallet
- **Sepolia testnet ETH** for contract deployment
- Environment variables in `.env.local` (see `.env.example`)

## Environment Setup

1. Clone the repository:
```bash
git clone https://github.com/your-org/clearfund.git
cd clearfund
```

2. Install dependencies:
```bash
pnpm install
```

3. Create `.env.local` from `.env.example`:
```bash
cp .env.example .env.local
```

4. Configure `.env.local` with:
   - `NEXT_PUBLIC_WALLETCONNECT_ID` – WalletConnect project ID
   - `HARDHAT_PRIVATE_KEY` – Deployer wallet private key (Sepolia)
   - `SEPOLIA_RPC_URL` – Sepolia RPC endpoint (Alchemy, Infura, etc.)

## Smart Contracts

### Overview
ClearFund uses two core contracts deployed on Sepolia:

**ClearFundFactory** – Registry contract that deploys individual campaign vaults.
- Emits `CampaignCreated` events with metadata (title, category, IPFS hash, goal).
- Maintains array of all deployed escrow contracts.
- Single owner (platform admin) who serves as verifier.

**CrowdfundEscrow** – Individual campaign vault with all-or-nothing funding and milestone-based releases.
- Accepts donations from multiple donors.
- Tracks total raised against goal.
- Implements milestone approval by verifier before fund release.
- Automatic refunds if campaign deadline passes without reaching goal.
- Reentrancy guard and access control (creator and verifier roles).

### Deployment

1. Compile contracts:
```bash
pnpm hardhat:compile
```

2. Deploy to Sepolia:
```bash
pnpm hardhat:deploy
```

3. Script outputs:
   - Factory address
   - Factory transaction hash
   - Event logs with deployed campaign addresses

4. Update contract addresses in `src/lib/contracts.tsx` and `deployment-info.json`.

### Verification

Deploy-time verification (if using Hardhat verification plugin):
```bash
pnpm hardhat:verify --network sepolia <CONTRACT_ADDRESS>
```

## Running the Application

### Development

```bash
pnpm dev
```

Starts Next.js development server on `http://localhost:3000`.

Features:
- Hot reload for frontend code
- TypeScript type checking
- ESLint real-time feedback
- Mock campaign data for UI testing

### Production Build

```bash
pnpm build
pnpm start
```

Creates optimized production bundle and runs via Node.

## Testing

### Smart Contracts

```bash
pnpm hardhat:test
```

Runs Hardhat test suite against local Hardhat network (no deployment required).

Example tests cover:
- Campaign creation via factory
- Donation acceptance and escrow balance updates
- Milestone approval and fund release
- Refund logic on failed campaigns

### Frontend

```bash
pnpm lint
```

Runs ESLint to catch TypeScript and code quality issues.

Note: Integration and e2e tests can be added; currently not present.

## Architecture

### Frontend Stack
- **Next.js 14** – App Router with Server Components for SSR
- **TypeScript** – Type safety across components and hooks
- **Tailwind CSS** – Utility-first styling
- **wagmi + viem** – Blockchain interaction and wallet connectivity
- **React Query** – Data fetching and caching
- **Lucide React** – Icon library

### Smart Contract Stack
- **Solidity ^0.8.19** – Contract language
- **Hardhat** – Development framework, testing, and deployment
- **TypeChain** – Type-safe contract bindings (autogenerated)

### Wallet Integration
- Connects via WalletConnect (v2)
- Supports MetaMask and other EVM-compatible wallets
- Real-time balance and transaction tracking via wagmi hooks

### On-Chain Data Flow
1. Creator deploys campaign via factory.
2. Factory emits `CampaignCreated` event with metadata.
3. Frontend reads contract state (totalRaised, goal, deadline) directly.
4. Donors interact with specific escrow contracts for donations and refunds.
5. Verifier (admin) approves milestones; funds unlock to creator.

## Configuration

### Contract Addresses

Update `src/lib/contracts.tsx` with deployed factory address:

```typescript
export const FACTORY_ADDRESS = "0x..."; // Your deployed factory
export const FACTORY_ABI = [ /* ABI array */ ];
export const ESCROW_ABI = [ /* ABI array */ ];
```

Address and ABI are auto-generated in `deployment-info.json` after deployment.

### Network Configuration

Default network: **Sepolia** (EVM testnet).

To switch networks, update `hardhat.config.ts` and environment variables. Contract source is network-agnostic; only deployment parameters change.

## Security Considerations

- **Reentrancy Guard** – Manual guard in `CrowdfundEscrow` prevents reentrancy attacks on fund withdrawals.
- **Access Control** – Creator and verifier roles strictly enforced.
- **All-or-Nothing Model** – Funds locked in escrow; donors refunded if goal not met.
- **Milestone Approval** – Verifier must approve before creator can withdraw; adds trust layer.
- **No External Dependencies** – Contracts are self-contained; no external calls to minimize risk.

### Recommended Practices
- Deploy with verified, non-compromised deployer key
- Conduct smart contract audit before mainnet deployment
- Limit verifier permissions to trusted admins
- Monitor escrow for unusual patterns (e.g., low goal, high withdrawals)

## Deployment Checklist

- [ ] Set `HARDHAT_PRIVATE_KEY` and `SEPOLIA_RPC_URL` in `.env.local`
- [ ] Run `pnpm hardhat:compile` (no errors)
- [ ] Run `pnpm hardhat:test` (all tests pass)
- [ ] Deploy: `pnpm hardhat:deploy`
- [ ] Verify factory address and update `src/lib/contracts.tsx`
- [ ] Build frontend: `pnpm build` (no errors)
- [ ] Test wallet connection and campaign creation on Sepolia
- [ ] Push to GitHub and deploy frontend to Vercel

## Troubleshooting

| Issue | Solution |
|-------|----------|
| `HARDHAT_PRIVATE_KEY not set` | Ensure `.env.local` contains valid private key |
| `Insufficient gas` | Fund deployer wallet with Sepolia ETH from faucet |
| `Contract not found at address` | Verify address in `contracts.tsx` matches deployment output |
| `Wallet connection fails` | Check `NEXT_PUBLIC_WALLETCONNECT_ID` is set correctly |
| `Build fails with TypeScript errors` | Run `pnpm hardhat:compile` to regenerate TypeChain types |

## License

MIT
